<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Call Center Dialer Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        .scrollbar-thin::-webkit-scrollbar {
            width: 8px;
        }
        .scrollbar-thin::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        .scrollbar-thin::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        .scrollbar-thin::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 min-h-screen">
    <div class="max-w-7xl mx-auto p-4">
        <!-- Header -->
        <div class="bg-white rounded-2xl shadow-xl p-6 mb-6">
            <div class="flex justify-between items-center flex-wrap gap-4">
                <div>
                    <h1 class="text-4xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent">
                        Call Center Dialer Pro
                    </h1>
                    <p class="text-gray-600 mt-2">Zaawansowany system obdzwaniania z integracjƒÖ Google Sheets</p>
                </div>
                <div class="flex gap-3">
                    <button onclick="loadSampleData()" class="px-5 py-2.5 bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 rounded-xl transition-all text-white font-semibold shadow-lg hover:shadow-xl">
                        Demo
                    </button>
                    <button onclick="loadFromGoogleSheets()" class="px-5 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl transition-all font-semibold flex items-center gap-2 shadow-lg hover:shadow-xl">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                        </svg>
                        Za≈Çaduj dane
                    </button>
                    <button onclick="toggleSettings()" class="p-3 bg-gray-100 hover:bg-gray-200 rounded-xl transition-colors shadow-md hover:shadow-lg">
                        <svg class="w-6 h-6 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- Settings Panel -->
        <div id="settingsPanel" class="bg-white rounded-2xl shadow-xl p-6 mb-6 hidden">
            <h2 class="text-2xl font-bold mb-6 text-gray-800">‚öôÔ∏è Ustawienia Google Sheets API</h2>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ID Arkusza Google Sheets</label>
                    <input type="text" id="googleSheetId" value="19aramNGcpY7ssEcpX34KPI5qmQUWQWVgAF-XC0WiKH8" placeholder="19aramNGcpY7ssEcpX34KPI5qmQUWQWVgAF-XC0WiKH8" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                    <p class="text-xs text-gray-500 mt-1">Z URL: docs.google.com/spreadsheets/d/<strong>ID_ARKUSZA</strong>/edit</p>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nazwa zak≈Çadki</label>
                    <input type="text" id="sheetName" value="Werka-Tabela" placeholder="Werka-Tabela" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Google API Key</label>
                    <input type="password" id="googleApiKey" placeholder="AIzaSy..." class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                </div>
                <div class="text-sm text-gray-600 bg-blue-50 p-5 rounded-xl border-2 border-blue-100">
                    <p class="font-medium mb-3 text-blue-900">üìã Instrukcja konfiguracji:</p>
                    <ol class="list-decimal list-inside space-y-2">
                        <li>Przejd≈∫ do Google Cloud Console</li>
                        <li>Utw√≥rz nowy projekt lub wybierz istniejƒÖcy</li>
                        <li>W≈ÇƒÖcz Google Sheets API</li>
                        <li>Utw√≥rz klucz API (Credentials ‚Üí Create Credentials ‚Üí API Key)</li>
                        <li>Udostƒôpnij arkusz: Share ‚Üí Anyone with the link (Viewer)</li>
                    </ol>
                </div>
            </div>
        </div>

        <!-- Statistics -->
        <div class="mb-6">
            <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4">
                <div class="bg-white rounded-xl shadow-lg p-4 border-l-4 border-blue-500">
                    <div class="text-2xl font-bold text-blue-600" id="statTotal">0</div>
                    <div class="text-sm text-gray-600">Wszystkie</div>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-4 border-l-4 border-green-500">
                    <div class="text-2xl font-bold text-green-600" id="statCompleted">0</div>
                    <div class="text-sm text-gray-600">Uko≈Ñczone</div>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-4 border-l-4 border-purple-500">
                    <div class="text-2xl font-bold text-purple-600" id="statMeeting">0</div>
                    <div class="text-sm text-gray-600">Spotkania</div>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-4 border-l-4 border-indigo-500">
                    <div class="text-2xl font-bold text-indigo-600" id="statContactAdvisor">0</div>
                    <div class="text-sm text-gray-600">Doradca</div>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-4 border-l-4 border-red-500">
                    <div class="text-2xl font-bold text-red-600" id="statNotInterested">0</div>
                    <div class="text-sm text-gray-600">Niezainteresowany</div>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-4 border-l-4 border-yellow-500">
                    <div class="text-2xl font-bold text-yellow-600" id="statFollowUp">0</div>
                    <div class="text-sm text-gray-600">Follow-up</div>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-4 border-l-4 border-orange-500">
                    <div class="text-2xl font-bold text-orange-600" id="statNoAnswer">0</div>
                    <div class="text-sm text-gray-600">Nie odbiera</div>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-4 border-l-4 border-gray-500">
                    <div class="text-2xl font-bold text-gray-600" id="statWrongNumber">0</div>
                    <div class="text-sm text-gray-600">B≈Çƒôdny nr</div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Left Panel - Contact Info -->
            <div class="lg:col-span-1">
                <div class="bg-white rounded-2xl shadow-xl p-6">
                    <!-- Progress Bar -->
                    <div class="mb-6">
                        <div class="flex justify-between text-sm text-gray-600 mb-2">
                            <span class="font-medium">Postƒôp: <span id="progressText">0 / 0</span></span>
                            <span class="font-bold"><span id="progressPercent">0</span>%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-3 overflow-hidden">
                            <div id="progressBar" class="bg-gradient-to-r from-blue-500 to-indigo-600 h-3 rounded-full transition-all duration-500 shadow-lg" style="width: 0%"></div>
                        </div>
                    </div>

                    <!-- Contact Display -->
                    <div id="contactDisplay">
                        <div class="text-center py-12">
                            <svg class="w-20 h-20 text-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                            </svg>
                            <p class="text-gray-500 text-lg mb-4">Brak kontakt√≥w</p>
                            <button onclick="loadFromGoogleSheets()" class="px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl">
                                Za≈Çaduj z Google Sheets
                            </button>
                        </div>
                    </div>

                    <!-- Call Timer -->
                    <div id="callTimer" class="mb-6 p-5 bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl border-2 border-green-300 shadow-lg hidden">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-3">
                                <div class="w-4 h-4 bg-green-500 rounded-full animate-pulse shadow-lg"></div>
                                <span class="text-green-700 font-bold text-lg">Po≈ÇƒÖczenie aktywne</span>
                            </div>
                            <span id="timerDisplay" class="text-3xl font-bold text-green-700 font-mono">0:00</span>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div id="actionButtons" class="space-y-3 hidden">
                        <button onclick="startCall()" id="startCallBtn" class="w-full bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white py-4 rounded-xl font-bold text-lg transition-all flex items-center justify-center gap-3 shadow-xl hover:shadow-2xl transform hover:scale-105">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                            </svg>
                            Zadzwo≈Ñ
                        </button>
                        <button onclick="skipContact()" id="skipBtn" class="w-full bg-gray-200 hover:bg-gray-300 text-gray-700 py-3 rounded-xl font-semibold transition-all flex items-center justify-center gap-2 shadow-md hover:shadow-lg">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5l7 7-7 7M5 5l7 7-7 7"></path>
                            </svg>
                            Pomi≈Ñ kontakt
                        </button>
                        <button onclick="endCallAndSave()" id="saveCallBtn" class="w-full bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white py-4 rounded-xl font-bold text-lg transition-all flex items-center justify-center gap-3 shadow-xl hover:shadow-2xl transform hover:scale-105 hidden">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path>
                            </svg>
                            Zapisz i zako≈Ñcz
                        </button>
                        <button onclick="endCall()" id="endCallBtn" class="w-full bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white py-3 rounded-xl font-semibold transition-all flex items-center justify-center gap-2 shadow-lg hover:shadow-xl hidden">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 8l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2M5 3a2 2 0 00-2 2v1c0 8.284 6.716 15 15 15h1a2 2 0 002-2v-3.28a1 1 0 00-.684-.948l-4.493-1.498a1 1 0 00-1.21.502l-1.13 2.257a11.042 11.042 0 01-5.516-5.517l2.257-1.128a1 1 0 00.502-1.21L9.228 3.683A1 1 0 008.279 3H5z"></path>
                            </svg>
                            Roz≈ÇƒÖcz bez zapisu
                        </button>
                    </div>
                </div>
            </div>

            <!-- Right Panel - Call Form -->
            <div class="lg:col-span-2">
                <div id="callFormPanel" class="bg-white rounded-2xl shadow-xl p-6 hidden">
                    <h3 class="text-2xl font-bold mb-6 text-gray-800">üìù Formularz rozmowy</h3>
                    
                    <div class="space-y-6 max-h-[700px] overflow-y-auto scrollbar-thin pr-2">
                        <!-- Call Status Buttons -->
                        <div class="bg-gray-50 rounded-xl p-6 border-2 border-gray-200">
                            <h4 class="text-lg font-bold text-gray-800 mb-4">Status po≈ÇƒÖczenia</h4>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                                <button onclick="setCallStatus('MEETING')" data-status="MEETING" class="status-btn px-4 py-3 rounded-lg font-semibold transition-all border-2 bg-white border-gray-200 text-gray-700 hover:border-purple-500 hover:bg-purple-50">
                                    Spotkanie
                                </button>
                                <button onclick="setCallStatus('CONTACT_ADVISOR')" data-status="CONTACT_ADVISOR" class="status-btn px-4 py-3 rounded-lg font-semibold transition-all border-2 bg-white border-gray-200 text-gray-700 hover:border-indigo-500 hover:bg-indigo-50">
                                    Kontakt z doradcƒÖ
                                </button>
                                <button onclick="setCallStatus('NOT_INTERESTED')" data-status="NOT_INTERESTED" class="status-btn px-4 py-3 rounded-lg font-semibold transition-all border-2 bg-white border-gray-200 text-gray-700 hover:border-red-500 hover:bg-red-50">
                                    Niezainteresowany
                                </button>
                                <button onclick="setCallStatus('FOLLOW_UP')" data-status="FOLLOW_UP" class="status-btn px-4 py-3 rounded-lg font-semibold transition-all border-2 bg-white border-gray-200 text-gray-700 hover:border-yellow-500 hover:bg-yellow-50">
                                    Do ponownego kontaktu
                                </button>
                                <button onclick="setCallStatus('NO_ANSWER')" data-status="NO_ANSWER" class="status-btn px-4 py-3 rounded-lg font-semibold transition-all border-2 bg-white border-gray-200 text-gray-700 hover:border-orange-500 hover:bg-orange-50">
                                    Nie odbiera
                                </button>
                                <button onclick="setCallStatus('WRONG_NUMBER')" data-status="WRONG_NUMBER" class="status-btn px-4 py-3 rounded-lg font-semibold transition-all border-2 bg-white border-gray-200 text-gray-700 hover:border-gray-500 hover:bg-gray-50">
                                    B≈Çƒôdny numer
                                </button>
                                <button onclick="setCallStatus('PENDING')" data-status="PENDING" class="status-btn px-4 py-3 rounded-lg font-semibold transition-all border-2 bg-white border-gray-200 text-gray-700 hover:border-blue-500 hover:bg-blue-50">
                                    OczekujƒÖce
                                </button>
                            </div>
                        </div>

                        <!-- Meeting Scheduler -->
                        <div id="meetingScheduler" class="bg-purple-50 border-2 border-purple-300 rounded-xl p-6 hidden">
                            <h4 class="text-lg font-bold text-purple-900 mb-4">üìÖ Planowanie spotkania</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-purple-900 mb-2">Data spotkania</label>
                                    <input type="date" id="meetingDate" class="w-full px-4 py-3 border-2 border-purple-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-purple-900 mb-2">Godzina spotkania</label>
                                    <input type="time" id="meetingTime" class="w-full px-4 py-3 border-2 border-purple-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all">
                                </div>
                            </div>
                        </div>

                        <!-- Follow-up Date -->
                        <div id="followUpScheduler" class="bg-yellow-50 border-2 border-yellow-300 rounded-xl p-6 hidden">
                            <h4 class="text-lg font-bold text-yellow-900 mb-4">üìÖ Data ponownego kontaktu</h4>
                            <input type="date" id="followUpDate" class="w-full px-4 py-3 border-2 border-yellow-200 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent transition-all">
                        </div>

                        <!-- Installation Details -->
                        <div class="bg-gray-50 rounded-xl p-6 border-2 border-gray-200">
                            <h4 class="text-lg font-bold text-gray-800 mb-4">üìä Szczeg√≥≈Çy instalacji</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Stan umowy</label>
                                    <input type="text" id="stanUmowy" placeholder="np. aktywna" class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Wielko≈õƒá instalacji</label>
                                    <input type="text" id="wielkoscInstalacji" placeholder="np. 6 kWp" class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Jak rachunki za prƒÖd?</label>
                                    <select id="jakRachunki" class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                                        <option value="">Wybierz...</option>
                                        <option value="Wysokie">Wysokie</option>
                                        <option value="≈örednie">≈örednie</option>
                                        <option value="Niskie">Niskie</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Ile p≈Çaci za prƒÖd?</label>
                                    <input type="text" id="ilePlaci" placeholder="np. 300 z≈Ç/mc" class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Czy ma foto?</label>
                                    <select id="czyMaFoto" class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                                        <option value="">Wybierz...</option>
                                        <option value="Tak">Tak</option>
                                        <option value="Nie">Nie</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Jakie zasady?</label>
                                    <input type="text" id="jakieZasady" placeholder="np. net-metering" class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Ile ma kWp?</label>
                                    <input type="text" id="ileKwp" placeholder="np. 5 kWp" class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Czy falownik hybrydowy?</label>
                                    <select id="czyFalownikHybrydowy" class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                                        <option value="">Wybierz...</option>
                                        <option value="Tak">Tak</option>
                                        <option value="Nie">Nie</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Czy ma magazyn energii?</label>
                                    <select id="czyMaMagazyn" class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                                        <option value="">Wybierz...</option>
                                        <option value="Tak">Tak</option>
                                        <option value="Nie">Nie</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Pojemno≈õƒá magazynu</label>
                                    <input type="text" id="pojemnoscMagazynu" placeholder="np. 10 kWh" class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Inne urzƒÖdzenia</label>
                                    <input type="text" id="inneUrzadzenia" placeholder="np. pompa ciep≈Ça" class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Czym ogrzewa?</label>
                                    <select id="czymOgrzewa" class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                                        <option value="">Wybierz...</option>
                                        <option value="Gaz">Gaz</option>
                                        <option value="PrƒÖd">PrƒÖd</option>
                                        <option value="Pompa ciep≈Ça">Pompa ciep≈Ça</option>
                                        <option value="Wƒôgiel">Wƒôgiel</option>
                                        <option value="Olej">Olej</option>
                                        <option value="Inne">Inne</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Zu≈ºycie prƒÖdu</label>
                                    <input type="text" id="zuzyciePrad" placeholder="np. 4000 kWh/rok" class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                                </div>
                            </div>
                        </div>

                        <!-- Comments -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Komentarz / Notatki</label>
                            <textarea id="komentarz" rows="4" placeholder="Dodatkowe informacje z rozmowy..." class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"></textarea>
                        </div>
                    </div>
                </div>

                <!-- Empty State -->
                <div id="emptyFormState" class="bg-white rounded-2xl shadow-xl p-12 text-center">
                    <svg class="w-20 h-20 text-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                    </svg>
                    <p class="text-gray-500 text-xl">Rozpocznij po≈ÇƒÖczenie aby wype≈Çniƒá formularz</p>
                </div>
            </div>
        </div>

        <!-- Instructions -->
        <div class="mt-6 bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-2xl p-6 shadow-lg">
            <h3 class="text-xl font-bold text-blue-900 mb-4">üìò Instrukcja u≈ºytkowania</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 text-sm text-blue-800">
                <div class="bg-white rounded-xl p-4 shadow-md">
                    <h4 class="font-bold mb-3 text-lg">1. Konfiguracja:</h4>
                    <ul class="list-disc list-inside space-y-2 ml-2">
                        <li>Kliknij ikonƒô ustawie≈Ñ (‚öôÔ∏è)</li>
                        <li>Wpisz ID arkusza Google Sheets</li>
                        <li>Dodaj klucz Google API</li>
                        <li>Kliknij "Za≈Çaduj dane"</li>
                    </ul>
                </div>
                <div class="bg-white rounded-xl p-4 shadow-md">
                    <h4 class="font-bold mb-3 text-lg">2. Obdzwanianie:</h4>
                    <ul class="list-disc list-inside space-y-2 ml-2">
                        <li>Kliknij "Zadzwo≈Ñ" aby rozpoczƒÖƒá</li>
                        <li>Wybierz status po≈ÇƒÖczenia</li>
                        <li>Wype≈Çnij formularz podczas rozmowy</li>
                        <li>Kliknij "Zapisz i zako≈Ñcz"</li>
                    </ul>
                </div>
                <div class="bg-white rounded-xl p-4 shadow-md">
                    <h4 class="font-bold mb-3 text-lg">3. Nowe statusy:</h4>
                    <ul class="list-disc list-inside space-y-2 ml-2">
                        <li><strong>Spotkanie</strong> - zaplanuj datƒô i godzinƒô</li>
                        <li><strong>Kontakt z doradcƒÖ</strong> - przeka≈º do zespo≈Çu</li>
                        <li><strong>Do ponownego kontaktu</strong> - ustaw przypomnienie</li>
                        <li><strong>Nie odbiera / B≈Çƒôdny numer</strong> - oznacz problem</li>
                    </ul>
                </div>
                <div class="bg-white rounded-xl p-4 shadow-md">
                    <h4 class="font-bold mb-3 text-lg">4. Statystyki:</h4>
                    <ul class="list-disc list-inside space-y-2 ml-2">
                        <li>Monitoruj postƒôp w czasie rzeczywistym</li>
                        <li>≈öled≈∫ wszystkie statusy osobno</li>
                        <li>Analizuj efektywno≈õƒá kampanii</li>
                        <li>Eksportuj dane do Google Sheets</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global State
        let contacts = [];
        let currentIndex = 0;
        let isCallActive = false;
        let callStartTime = null;
        let timerInterval = null;
        let stats = {
            total: 0,
            completed: 0,
            meeting: 0,
            contactAdvisor: 0,
            notInterested: 0,
            followUp: 0,
            noAnswer: 0,
            wrongNumber: 0
        };
        let callData = {
            data: '',
            stanUmowy: '',
            wielkoscInstalacji: '',
            jakRachunki: '',
            ilePlaci: '',
            czyMaFoto: '',
            jakieZasady: '',
            ileKwp: '',
            czyFalownikHybrydowy: '',
            czyMaMagazyn: '',
            pojemnoscMagazynu: '',
            inneUrzadzenia: '',
            czymOgrzewa: '',
            zuzyciePrad: '',
            komentarz: '',
            zainteresowany: '',
            callStatus: 'PENDING',
            meetingDate: '',
            meetingTime: '',
            followUpDate: ''
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('meetingDate').setAttribute('min', today);
            document.getElementById('followUpDate').setAttribute('min', today);
        });

        // Toggle Settings
        function toggleSettings() {
            const panel = document.getElementById('settingsPanel');
            panel.classList.toggle('hidden');
        }

        // Load Sample Data
        function loadSampleData() {
            contacts = [
                { 
                    id: 1, rowNumber: 2, name: 'Jan Kowalski', phone: '+48 123 456 789', 
                    address: 'ul. G≈Ç√≥wna 1', postalCode: '00-001', province: 'Mazowieckie',
                    data: new Date().toLocaleDateString('pl-PL'),
                    stanUmowy: '', wielkoscInstalacji: '', jakRachunki: '', ilePlaci: '',
                    czyMaFoto: '', jakieZasady: '', ileKwp: '', czyFalownikHybrydowy: '',
                    czyMaMagazyn: '', pojemnoscMagazynu: '', inneUrzadzenia: '',
                    czymOgrzewa: '', zuzyciePrad: '', komentarz: '', zainteresowany: ''
                },
                { 
                    id: 2, rowNumber: 3, name: 'Anna Nowak', phone: '+48 987 654 321', 
                    address: 'ul. Kwiatowa 5', postalCode: '30-001', province: 'Ma≈Çopolskie',
                    data: new Date().toLocaleDateString('pl-PL'),
                    stanUmowy: '', wielkoscInstalacji: '', jakRachunki: '', ilePlaci: '',
                    czyMaFoto: '', jakieZasady: '', ileKwp: '', czyFalownikHybrydowy: '',
                    czyMaMagazyn: '', pojemnoscMagazynu: '', inneUrzadzenia: '',
                    czymOgrzewa: '', zuzyciePrad: '', komentarz: '', zainteresowany: ''
                },
                { 
                    id: 3, rowNumber: 4, name: 'Piotr Wi≈õniewski', phone: '+48 555 444 333', 
                    address: 'ul. S≈Çoneczna 12', postalCode: '80-001', province: 'Pomorskie',
                    data: new Date().toLocaleDateString('pl-PL'),
                    stanUmowy: '', wielkoscInstalacji: '', jakRachunki: '', ilePlaci: '',
                    czyMaFoto: '', jakieZasady: '', ileKwp: '', czyFalownikHybrydowy: '',
                    czyMaMagazyn: '', pojemnoscMagazynu: '', inneUrzadzenia: '',
                    czymOgrzewa: '', zuzyciePrad: '', komentarz: '', zainteresowany: ''
                }
            ];
            currentIndex = 0;
            stats.total = contacts.length;
            updateStats();
            updateProgress();
            displayCurrentContact();
            alert('‚úì Za≈Çadowano przyk≈Çadowe dane');
        }

        // Load from Google Sheets
        async function loadFromGoogleSheets() {
            const googleApiKey = document.getElementById('googleApiKey').value;
            const googleSheetId = document.getElementById('googleSheetId').value;
            const sheetName = document.getElementById('sheetName').value;

            if (!googleApiKey || !googleSheetId) {
                alert('Proszƒô podaƒá API Key i ID arkusza w ustawieniach');
                return;
            }

            try {
                const range = `${sheetName}!A2:Y1000`;
                const url = `https://sheets.googleapis.com/v4/spreadsheets/${googleSheetId}/values/${range}?key=${googleApiKey}`;
                
                const response = await fetch(url);
                const data = await response.json();
                
                if (data.values && data.values.length > 0) {
                    contacts = data.values
                        .filter(row => row[1] && row[5])
                        .map((row, index) => ({
                            id: index + 1,
                            rowNumber: index + 2,
                            data: row[0] || '',
                            name: row[1] || '',
                            address: row[2] || '',
                            postalCode: row[3] || '',
                            province: row[4] || '',
                            phone: row[5] || '',
                            stanUmowy: row[6] || '',
                            wielkoscInstalacji: row[7] || '',
                            jakRachunki: row[8] || '',
                            ilePlaci: row[9] || '',
                            czyMaFoto: row[10] || '',
                            jakieZasady: row[11] || '',
                            ileKwp: row[12] || '',
                            czyFalownikHybrydowy: row[13] || '',
                            czyMaMagazyn: row[14] || '',
                            pojemnoscMagazynu: row[15] || '',
                            inneUrzadzenia: row[16] || '',
                            czymOgrzewa: row[17] || '',
                            zuzyciePrad: row[18] || '',
                            komentarz: row[19] || '',
                            zainteresowany: row[20] || '',
                            callStatus: row[21] || 'PENDING',
                            meetingDate: row[22] || '',
                            meetingTime: row[23] || '',
                            followUpDate: row[24] || ''
                        }));
                    
                    currentIndex = 0;
                    stats.total = contacts.length;
                    updateStats();
                    updateProgress();
                    displayCurrentContact();
                    alert(`‚úì Za≈Çadowano ${contacts.length} kontakt√≥w z Google Sheets`);
                } else {
                    alert('Brak danych w arkuszu lub arkusz jest pusty');
                }
            } catch (error) {
                console.error('B≈ÇƒÖd ≈Çadowania danych:', error);
                alert('B≈ÇƒÖd podczas ≈Çadowania danych z Google Sheets. Sprawd≈∫ API Key i uprawnienia arkusza.');
            }
        }

        // Save to Google Sheets - POPRAWIONA FUNKCJA
        async function saveToGoogleSheets() {
            const googleApiKey = document.getElementById('googleApiKey').value;
            const googleSheetId = document.getElementById('googleSheetId').value;
            const sheetName = document.getElementById('sheetName').value;

            if (!googleApiKey || !googleSheetId) {
                console.log('Tryb demo - dane nie zostanƒÖ zapisane do Google Sheets');
                return true;
            }

            try {
                const currentContact = contacts[currentIndex];
                const rowNumber = currentContact.rowNumber;
                const range = `${sheetName}!A${rowNumber}:Y${rowNumber}`;
                
                // Przygotowanie danych do zapisu - wszystkie 25 kolumn (A-Y)
                const values = [[
                    callData.data || new Date().toLocaleDateString('pl-PL'),
                    currentContact.name,
                    currentContact.address,
                    currentContact.postalCode,
                    currentContact.province,
                    currentContact.phone,
                    callData.stanUmowy,
                    callData.wielkoscInstalacji,
                    callData.jakRachunki,
                    callData.ilePlaci,
                    callData.czyMaFoto,
                    callData.jakieZasady,
                    callData.ileKwp,
                    callData.czyFalownikHybrydowy,
                    callData.czyMaMagazyn,
                    callData.pojemnoscMagazynu,
                    callData.inneUrzadzenia,
                    callData.czymOgrzewa,
                    callData.zuzyciePrad,
                    callData.komentarz,
                    callData.zainteresowany,
                    callData.callStatus,
                    callData.meetingDate,
                    callData.meetingTime,
                    callData.followUpDate
                ]];

                // U≈ºycie prawid≈Çowego endpointu Google Sheets API: values:update
                const url = `https://sheets.googleapis.com/v4/spreadsheets/${googleSheetId}/values/${encodeURIComponent(range)}?valueInputOption=USER_ENTERED&key=${googleApiKey}`;
                
                const response = await fetch(url, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        range: range,
                        majorDimension: 'ROWS',
                        values: values
                    })
                });

                const result = await response.json();

                if (response.ok && result.updatedCells) {
                    console.log(`‚úì Zapisano ${result.updatedCells} kom√≥rek do wiersza ${rowNumber}`);
                    return true;
                } else {
                    console.error('B≈ÇƒÖd odpowiedzi API:', result);
                    throw new Error(result.error?.message || 'B≈ÇƒÖd zapisu do Google Sheets');
                }
            } catch (error) {
                console.error('B≈ÇƒÖd zapisywania danych:', error);
                alert(`B≈ÇƒÖd podczas zapisywania danych do Google Sheets: ${error.message}\n\nSprawd≈∫:\n- Czy API Key jest poprawny\n- Czy arkusz jest udostƒôpniony\n- Czy Google Sheets API jest w≈ÇƒÖczone w projekcie`);
                return false;
            }
        }

        // Display Current Contact
        function displayCurrentContact() {
            if (contacts.length === 0 || currentIndex >= contacts.length) {
                document.getElementById('contactDisplay').innerHTML = `
                    <div class="text-center py-12">
                        <svg class="w-20 h-20 text-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                        </svg>
                        <p class="text-gray-500 text-lg mb-4">Brak kontakt√≥w</p>
                        <button onclick="loadFromGoogleSheets()" class="px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl">
                            Za≈Çaduj z Google Sheets
                        </button>
                    </div>
                `;
                document.getElementById('actionButtons').classList.add('hidden');
                return;
            }

            const contact = contacts[currentIndex];
            document.getElementById('contactDisplay').innerHTML = `
                <div class="flex flex-col items-center mb-6">
                    <div class="w-24 h-24 bg-gradient-to-br from-blue-400 via-indigo-500 to-purple-500 rounded-full flex items-center justify-center mb-4 shadow-xl">
                        <svg class="w-12 h-12 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                        </svg>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-800 text-center">${contact.name}</h2>
                    <p class="text-xl text-blue-600 font-semibold mt-2">${contact.phone}</p>
                    <div class="mt-3 text-center">
                        <p class="text-sm text-gray-600">${contact.address}</p>
                        <p class="text-sm text-gray-600">${contact.postalCode} ${contact.province}</p>
                    </div>
                </div>
            `;
            document.getElementById('actionButtons').classList.remove('hidden');
        }

        // Update Progress
        function updateProgress() {
            const progress = contacts.length > 0 ? ((currentIndex / contacts.length) * 100).toFixed(0) : 0;
            document.getElementById('progressText').textContent = `${currentIndex + 1} / ${contacts.length}`;
            document.getElementById('progressPercent').textContent = progress;
            document.getElementById('progressBar').style.width = `${progress}%`;
        }

        // Update Stats
        function updateStats() {
            document.getElementById('statTotal').textContent = stats.total;
            document.getElementById('statCompleted').textContent = stats.completed;
            document.getElementById('statMeeting').textContent = stats.meeting;
            document.getElementById('statContactAdvisor').textContent = stats.contactAdvisor;
            document.getElementById('statNotInterested').textContent = stats.notInterested;
            document.getElementById('statFollowUp').textContent = stats.followUp;
            document.getElementById('statNoAnswer').textContent = stats.noAnswer;
            document.getElementById('statWrongNumber').textContent = stats.wrongNumber;
        }

        // Start Call
        function startCall() {
            if (contacts.length === 0 || currentIndex >= contacts.length) {
                alert('Brak kontakt√≥w do obdzwonienia');
                return;
            }
            
            const currentContact = contacts[currentIndex];
            
            // Reset call data
            callData = {
                data: new Date().toLocaleDateString('pl-PL'),
                stanUmowy: currentContact.stanUmowy || '',
                wielkoscInstalacji: currentContact.wielkoscInstalacji || '',
                jakRachunki: currentContact.jakRachunki || '',
                ilePlaci: currentContact.ilePlaci || '',
                czyMaFoto: currentContact.czyMaFoto || '',
                jakieZasady: currentContact.jakieZasady || '',
                ileKwp: currentContact.ileKwp || '',
                czyFalownikHybrydowy: currentContact.czyFalownikHybrydowy || '',
                czyMaMagazyn: currentContact.czyMaMagazyn || '',
                pojemnoscMagazynu: currentContact.pojemnoscMagazynu || '',
                inneUrzadzenia: currentContact.inneUrzadzenia || '',
                czymOgrzewa: currentContact.czymOgrzewa || '',
                zuzyciePrad: currentContact.zuzyciePrad || '',
                komentarz: currentContact.komentarz || '',
                zainteresowany: currentContact.zainteresowany || '',
                callStatus: 'PENDING',
                meetingDate: '',
                meetingTime: '',
                followUpDate: ''
            };
            
            // Populate form fields
            document.getElementById('stanUmowy').value = callData.stanUmowy;
            document.getElementById('wielkoscInstalacji').value = callData.wielkoscInstalacji;
            document.getElementById('jakRachunki').value = callData.jakRachunki;
            document.getElementById('ilePlaci').value = callData.ilePlaci;
            document.getElementById('czyMaFoto').value = callData.czyMaFoto;
            document.getElementById('jakieZasady').value = callData.jakieZasady;
            document.getElementById('ileKwp').value = callData.ileKwp;
            document.getElementById('czyFalownikHybrydowy').value = callData.czyFalownikHybrydowy;
            document.getElementById('czyMaMagazyn').value = callData.czyMaMagazyn;
            document.getElementById('pojemnoscMagazynu').value = callData.pojemnoscMagazynu;
            document.getElementById('inneUrzadzenia').value = callData.inneUrzadzenia;
            document.getElementById('czymOgrzewa').value = callData.czymOgrzewa;
            document.getElementById('zuzyciePrad').value = callData.zuzyciePrad;
            document.getElementById('komentarz').value = callData.komentarz;
            
            isCallActive = true;
            callStartTime = Date.now();
            
            // Start timer
            timerInterval = setInterval(updateTimer, 1000);
            
            // Update UI
            document.getElementById('callTimer').classList.remove('hidden');
            document.getElementById('startCallBtn').classList.add('hidden');
            document.getElementById('skipBtn').classList.add('hidden');
            document.getElementById('saveCallBtn').classList.remove('hidden');
            document.getElementById('endCallBtn').classList.remove('hidden');
            document.getElementById('callFormPanel').classList.remove('hidden');
            document.getElementById('emptyFormState').classList.add('hidden');
            
            console.log(`üìû Dzwoniƒô do: ${currentContact.name} (${currentContact.phone})`);
        }

        // Update Timer
        function updateTimer() {
            if (isCallActive && callStartTime) {
                const seconds = Math.floor((Date.now() - callStartTime) / 1000);
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                document.getElementById('timerDisplay').textContent = `${mins}:${secs.toString().padStart(2, '0')}`;
            }
        }

        // End Call and Save
        async function endCallAndSave() {
            if (!isCallActive) return;

            // Get form data
            callData.stanUmowy = document.getElementById('stanUmowy').value;
            callData.wielkoscInstalacji = document.getElementById('wielkoscInstalacji').value;
            callData.jakRachunki = document.getElementById('jakRachunki').value;
            callData.ilePlaci = document.getElementById('ilePlaci').value;
            callData.czyMaFoto = document.getElementById('czyMaFoto').value;
            callData.jakieZasady = document.getElementById('jakieZasady').value;
            callData.ileKwp = document.getElementById('ileKwp').value;
            callData.czyFalownikHybrydowy = document.getElementById('czyFalownikHybrydowy').value;
            callData.czyMaMagazyn = document.getElementById('czyMaMagazyn').value;
            callData.pojemnoscMagazynu = document.getElementById('pojemnoscMagazynu').value;
            callData.inneUrzadzenia = document.getElementById('inneUrzadzenia').value;
            callData.czymOgrzewa = document.getElementById('czymOgrzewa').value;
            callData.zuzyciePrad = document.getElementById('zuzyciePrad').value;
            callData.komentarz = document.getElementById('komentarz').value;
            callData.meetingDate = document.getElementById('meetingDate').value;
            callData.meetingTime = document.getElementById('meetingTime').value;
            callData.followUpDate = document.getElementById('followUpDate').value;

            // Validation for MEETING status
            if (callData.callStatus === 'MEETING') {
                if (!callData.meetingDate || !callData.meetingTime) {
                    alert('Proszƒô wybraƒá datƒô i godzinƒô spotkania');
                    return;
                }
            }
            
            const saved = await saveToGoogleSheets();
            
            if (saved) {
                stats.completed++;
                
                // Update stats based on status
                switch (callData.callStatus) {
                    case 'MEETING':
                        stats.meeting++;
                        break;
                    case 'CONTACT_ADVISOR':
                        stats.contactAdvisor++;
                        break;
                    case 'NOT_INTERESTED':
                        stats.notInterested++;
                        break;
                    case 'FOLLOW_UP':
                        stats.followUp++;
                        break;
                    case 'NO_ANSWER':
                        stats.noAnswer++;
                        break;
                    case 'WRONG_NUMBER':
                        stats.wrongNumber++;
                        break;
                }
                
                updateStats();
                
                const googleApiKey = document.getElementById('googleApiKey').value;
                if (!googleApiKey) {
                    alert('‚úì Dane zapisane lokalnie (tryb demo)!\n\nAby zapisaƒá do Google Sheets, skonfiguruj API Key w ustawieniach.');
                } else {
                    alert('‚úì Dane zapisane do Google Sheets!');
                }
                
                endCall();
            }
        }

        // End Call
        function endCall() {
            isCallActive = false;
            callStartTime = null;
            
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
            
            // Reset UI
            document.getElementById('callTimer').classList.add('hidden');
            document.getElementById('timerDisplay').textContent = '0:00';
            document.getElementById('startCallBtn').classList.remove('hidden');
            document.getElementById('skipBtn').classList.remove('hidden');
            document.getElementById('saveCallBtn').classList.add('hidden');
            document.getElementById('endCallBtn').classList.add('hidden');
            document.getElementById('callFormPanel').classList.add('hidden');
            document.getElementById('emptyFormState').classList.remove('hidden');
            
            // Reset form
            document.querySelectorAll('.status-btn').forEach(btn => {
                btn.classList.remove('border-purple-500', 'bg-purple-100', 'border-indigo-500', 'bg-indigo-100', 
                    'border-red-500', 'bg-red-100', 'border-yellow-500', 'bg-yellow-100', 
                    'border-orange-500', 'bg-orange-100', 'border-gray-500', 'bg-gray-100',
                    'border-blue-500', 'bg-blue-100');
                btn.classList.add('border-gray-200', 'bg-white');
            });
            document.getElementById('meetingScheduler').classList.add('hidden');
            document.getElementById('followUpScheduler').classList.add('hidden');
            
            // Move to next contact
            if (currentIndex < contacts.length - 1) {
                currentIndex++;
                updateProgress();
                displayCurrentContact();
            } else {
                alert('üéâ Wszystkie kontakty obdzwonione!');
            }
        }

        // Skip Contact
        function skipContact() {
            if (currentIndex < contacts.length - 1) {
                currentIndex++;
                updateProgress();
                displayCurrentContact();
            } else {
                alert('To by≈Ç ostatni kontakt');
            }
        }

        // Set Call Status
        function setCallStatus(status) {
            callData.callStatus = status;
            
            // Update button styles
            document.querySelectorAll('.status-btn').forEach(btn => {
                btn.classList.remove('border-purple-500', 'bg-purple-100', 'border-indigo-500', 'bg-indigo-100', 
                    'border-red-500', 'bg-red-100', 'border-yellow-500', 'bg-yellow-100', 
                    'border-orange-500', 'bg-orange-100', 'border-gray-500', 'bg-gray-100',
                    'border-blue-500', 'bg-blue-100');
                btn.classList.add('border-gray-200', 'bg-white');
            });
            
            const selectedBtn = document.querySelector(`[data-status="${status}"]`);
            if (selectedBtn) {
                selectedBtn.classList.remove('border-gray-200', 'bg-white');
                switch(status) {
                    case 'MEETING':
                        selectedBtn.classList.add('border-purple-500', 'bg-purple-100');
                        break;
                    case 'CONTACT_ADVISOR':
                        selectedBtn.classList.add('border-indigo-500', 'bg-indigo-100');
                        break;
                    case 'NOT_INTERESTED':
                        selectedBtn.classList.add('border-red-500', 'bg-red-100');
                        break;
                    case 'FOLLOW_UP':
                        selectedBtn.classList.add('border-yellow-500', 'bg-yellow-100');
                        break;
                    case 'NO_ANSWER':
                        selectedBtn.classList.add('border-orange-500', 'bg-orange-100');
                        break;
                    case 'WRONG_NUMBER':
                        selectedBtn.classList.add('border-gray-500', 'bg-gray-100');
                        break;
                    case 'PENDING':
                        selectedBtn.classList.add('border-blue-500', 'bg-blue-100');
                        break;
                }
            }
            
            // Show/hide conditional panels
            document.getElementById('meetingScheduler').classList.toggle('hidden', status !== 'MEETING');
            document.getElementById('followUpScheduler').classList.toggle('hidden', status !== 'FOLLOW_UP');
        }
    </script>
</body>
</html>
